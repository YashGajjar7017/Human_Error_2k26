# Failed Login Redirect - Visual Guide

## ðŸŽ¯ High-Level Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER ATTEMPTS LOGIN                          â”‚
â”‚                   (Port 3000 Frontend)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ POST /Account/login
                         â”‚ { username, password }
                         â”‚
                         â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Frontend Controller             â”‚
          â”‚  - Validates input               â”‚
          â”‚  - Calls FetchData()             â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ axios.post()
                           â”‚ http://localhost:8000/api/login
                           â”‚
                           â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Backend Controller              â”‚
          â”‚  - Check user exists             â”‚
          â”‚  - Validate password             â”‚
          â”‚  - Check email verified          â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ SUCCESS                                â”‚ FAILURE
         â”‚                                        â”‚
         â–¼                                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Generate    â”‚                   â”‚ Return error:      â”‚
    â”‚ JWT Token   â”‚                   â”‚ - Invalid creds    â”‚
    â”‚             â”‚                   â”‚ - Email unverified â”‚
    â”‚ Return:     â”‚                   â”‚ - User not found   â”‚
    â”‚ {           â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  success:   â”‚                            â”‚
    â”‚  true,      â”‚                            â–¼
    â”‚  token,     â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  user       â”‚                  â”‚ Frontend receives:      â”‚
    â”‚ }           â”‚                  â”‚ { success: false,       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â”‚   message: "..." }     â”‚
             â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â–¼                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ Build URL with
    â”‚ Store token in      â”‚                   â”‚ query parameters:
    â”‚ localStorage        â”‚                   â”‚ email=X
    â”‚                     â”‚                   â”‚ failedLogin=true
    â”‚ Redirect to:        â”‚                   â”‚
    â”‚ /                   â”‚                   â–¼
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Redirect to:         â”‚
                                      â”‚ /Account/Signup?     â”‚
                                      â”‚ email=user@...       â”‚
                                      â”‚ &failedLogin=true    â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Frontend signUp()    â”‚
                                      â”‚ GET /Account/Signup  â”‚
                                      â”‚ {token}?email=X...   â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Server extracts:     â”‚
                                      â”‚ - email from query   â”‚
                                      â”‚ - failedLogin flag   â”‚
                                      â”‚                      â”‚
                                      â”‚ Serves Signup.html   â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Browser loads HTML:  â”‚
                                      â”‚                      â”‚
                                      â”‚ JavaScript executes: â”‚
                                      â”‚ 1. Get URL params    â”‚
                                      â”‚ 2. Pre-fill email    â”‚
                                      â”‚ 3. Show alert        â”‚
                                      â”‚ 4. Focus username    â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ SIGNUP PAGE READY    â”‚
                                      â”‚                      â”‚
                                      â”‚ Shows:               â”‚
                                      â”‚ - Warning alert      â”‚
                                      â”‚ - Pre-filled email   â”‚
                                      â”‚ - Username field     â”‚
                                      â”‚ - Password fields    â”‚
                                      â”‚ - Sign Up button     â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š Request/Response Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚                          â”‚                  â”‚
â”‚  Browser Client â”‚                          â”‚  Backend Server  â”‚
â”‚  (Port 3000)    â”‚                          â”‚  (Port 8000)     â”‚
â”‚                 â”‚                          â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                            â”‚
         â”‚                                            â”‚
         â”‚â”€â”€â”€â”€â”€â”€ 1. POST /Account/login â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
         â”‚       { username, password }               â”‚
         â”‚                                            â”‚
         â”‚                                            â”‚ Validates
         â”‚                                            â”‚ credentials
         â”‚                                            â”‚
         â”‚<â”€â”€â”€â”€â”€ 2A. Response (SUCCESS) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
         â”‚       { success: true,                    â”‚
         â”‚         token: "...",                     â”‚
         â”‚         user: {...} }                     â”‚
         â”‚                                            â”‚
         â”‚  Store token in localStorage               â”‚
         â”‚  Redirect to /                             â”‚
         â”‚                                            â”‚
         â”‚                                            â”‚
         â”‚â”€â”€â”€â”€â”€â”€ 2B. Response (FAILURE) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
         â”‚       { success: false,                   â”‚
         â”‚         message: "Invalid..." }           â”‚
         â”‚                                            â”‚
         â”‚  Extract email from request                â”‚
         â”‚  Build signup URL                          â”‚
         â”‚  window.location.href =                    â”‚
         â”‚    "/Account/Signup?                       â”‚
         â”‚     email=user@...&                        â”‚
         â”‚     failedLogin=true"                      â”‚
         â”‚                                            â”‚
         â”‚                                            â”‚
         â”‚â”€â”€â”€â”€â”€â”€ 3. GET /Account/Signup/{token} â”€â”€â”€>â”‚
         â”‚       ?email=user@...&failedLogin=true    â”‚
         â”‚                                            â”‚
         â”‚                                            â”‚ Extract
         â”‚                                            â”‚ query params
         â”‚                                            â”‚
         â”‚<â”€â”€â”€â”€â”€ 4. Signup.html â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
         â”‚       (HTML file)                         â”‚
         â”‚                                            â”‚
         â”‚  Browser loads HTML                        â”‚
         â”‚  JavaScript runs:                          â”‚
         â”‚  - Gets URL params                         â”‚
         â”‚  - Pre-fills email                         â”‚
         â”‚  - Shows warning alert                     â”‚
         â”‚                                            â”‚
         â”‚  (User fills form and submits)             â”‚
         â”‚                                            â”‚
         â”‚â”€â”€â”€â”€â”€â”€ 5. POST /Account/Signup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
         â”‚       { username, email,                  â”‚
         â”‚         password, confirmPassword }       â”‚
         â”‚                                            â”‚
         â”‚                                            â”‚ Creates user
         â”‚                                            â”‚ Sends OTP
         â”‚                                            â”‚
         â”‚<â”€â”€â”€â”€â”€ 6. Response (SUCCESS) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
         â”‚       { success: true,                    â”‚
         â”‚         message: "OTP sent",              â”‚
         â”‚         redirectUrl: "..." }              â”‚
         â”‚                                            â”‚
         â”‚  Redirect to OTP page                      â”‚
         â”‚  User enters OTP from email                â”‚
         â”‚  (Continue with OTP verification)          â”‚
         â”‚                                            â”‚
```

---

## ðŸ”€ State Changes Diagram

```
LOGIN PAGE STATE
â”œâ”€â”€ Initial
â”‚   â””â”€â”€ username: ""
â”‚   â””â”€â”€ password: ""
â”‚
â””â”€â”€ After User Input
    â””â”€â”€ username: "user@example.com"
    â””â”€â”€ password: "mypassword"
         â”‚
         â–¼
    SUBMITTING
    â””â”€â”€ Loading...
         â”‚
         â–¼
    RESPONSE
    â”œâ”€â”€ SUCCESS
    â”‚   â””â”€â”€ Store token
    â”‚   â””â”€â”€ Redirect to home
    â”‚
    â””â”€â”€ FAILURE
        â””â”€â”€ Build signup URL
        â””â”€â”€ Redirect to signup


SIGNUP PAGE STATE
â”œâ”€â”€ Initial (from failed login)
â”‚   â””â”€â”€ email: "" (not filled yet)
â”‚   â””â”€â”€ username: ""
â”‚   â””â”€â”€ password: ""
â”‚   â””â”€â”€ confirmPassword: ""
â”‚   â””â”€â”€ failedLoginAlert: HIDDEN
â”‚
â”œâ”€â”€ After Load (JavaScript runs)
â”‚   â””â”€â”€ email: "user@example.com" (PRE-FILLED)
â”‚   â””â”€â”€ username: ""
â”‚   â””â”€â”€ password: ""
â”‚   â””â”€â”€ confirmPassword: ""
â”‚   â””â”€â”€ failedLoginAlert: VISIBLE
â”‚   â””â”€â”€ username field: FOCUSED
â”‚
â””â”€â”€ After User Input
    â””â”€â”€ email: "user@example.com"
    â””â”€â”€ username: "newuser"
    â””â”€â”€ password: "password123"
    â””â”€â”€ confirmPassword: "password123"
         â”‚
         â–¼
    SUBMITTING
    â””â”€â”€ Loading...
         â”‚
         â–¼
    RESPONSE
    â””â”€â”€ SUCCESS
        â””â”€â”€ Redirect to OTP page
```

---

## ðŸ”‘ Key Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. LOGIN ATTEMPT                       â”‚
â”‚  â”œâ”€â”€ Input: username, password          â”‚
â”‚  â”œâ”€â”€ Endpoint: POST /Account/login      â”‚
â”‚  â”œâ”€â”€ Backend: POST /api/login           â”‚
â”‚  â””â”€â”€ Output: { success, message }       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  â”‚
    â–¼                  â–¼
 SUCCESS            FAILURE
    â”‚                  â”‚
    â”‚                  â–¼
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚ 2. BUILD URL     â”‚
    â”‚         â”œâ”€â”€ Base: /Account â”‚
    â”‚         â”‚     /Signup      â”‚
    â”‚         â”œâ”€â”€ Param 1:       â”‚
    â”‚         â”‚   email=username â”‚
    â”‚         â”‚   (URL-encoded)  â”‚
    â”‚         â”œâ”€â”€ Param 2:       â”‚
    â”‚         â”‚   failedLogin=   â”‚
    â”‚         â”‚   true           â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚
    â”‚                  â–¼
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚ 3. REDIRECT          â”‚
    â”‚         â”œâ”€â”€ Location: URL      â”‚
    â”‚         â”‚   from step 2        â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚
    â”‚                  â–¼
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚ 4. LOAD SIGNUP PAGE  â”‚
    â”‚         â”œâ”€â”€ Fetch HTML         â”‚
    â”‚         â”œâ”€â”€ JavaScript runs    â”‚
    â”‚         â”‚   in browser         â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚
    â”‚                  â–¼
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚ 5. PARSE PARAMS      â”‚
    â”‚         â”œâ”€â”€ const urlParams =  â”‚
    â”‚         â”‚   URLSearchParams    â”‚
    â”‚         â”œâ”€â”€ email = params.    â”‚
    â”‚         â”‚   get('email')       â”‚
    â”‚         â”œâ”€â”€ failedLogin =      â”‚
    â”‚         â”‚   params.get(...)    â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚
    â”‚                  â–¼
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚ 6. MODIFY PAGE       â”‚
    â”‚         â”œâ”€â”€ document.getElementById
    â”‚         â”‚   ('email').value =  â”‚
    â”‚         â”‚   decodeURIComponent â”‚
    â”‚         â”‚   (email)            â”‚
    â”‚         â”œâ”€â”€ Show alert if      â”‚
    â”‚         â”‚   failedLogin===true â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚
    â”‚                  â–¼
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚ 7. USER SEES         â”‚
    â”‚         â”œâ”€â”€ Warning alert      â”‚
    â”‚         â”œâ”€â”€ Email pre-filled   â”‚
    â”‚         â”œâ”€â”€ Ready for signup   â”‚
    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Store token in       â”‚
â”‚ localStorage         â”‚
â”‚                      â”‚
â”‚ Redirect to home (/) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“ˆ Success Metrics

Track these to ensure feature is working:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ METRIC                    â”‚ EXPECTED VALUE  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Redirect on failed login  â”‚ 100%            â”‚
â”‚ Email pre-filled          â”‚ 100%            â”‚
â”‚ Alert shown               â”‚ 100%            â”‚
â”‚ User can signup           â”‚ 100%            â”‚
â”‚ OTP sent successfully     â”‚ 100%            â”‚
â”‚ Email verification works  â”‚ 100%            â”‚
â”‚ Login after signup        â”‚ 100%            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”— Related Pages & Routes

```
/Account/login
    â”‚
    â”œâ”€â”€â”€ SUCCESS â”€â”€â†’ / (home page)
    â”‚
    â””â”€â”€â”€ FAILURE â”€â”€â†’ /Account/Signup?email=X&failedLogin=true
                           â”‚
                           â”œâ”€â”€â”€ Signup Form
                           â”‚
                           â””â”€â”€â”€ POST /Account/Signup
                                    â”‚
                                    â””â”€â†’ /Account/sendOTP
                                         â”‚
                                         â””â”€â†’ OTP Verification
                                              â”‚
                                              â””â”€â†’ / (home page)
```
